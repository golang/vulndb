modules:
  - module: mellium.im/xmpp
    versions:
      - introduced: 0.18.0
        fixed: 0.21.1
    vulnerable_at: 0.21.0
    packages:
      - package: mellium.im/xmpp/websocket
        symbols:
          - Dialer.config
        derived_symbols:
          - Dial
          - DialDirect
          - DialSession
          - Dialer.Dial
          - Dialer.DialDirect
          - NewClient
description: |
    In Mellium mellium.im/xmpp, an attacker capable of spoofing DNS TXT records
    can redirect a WebSocket connection request to a server under their control
    without causing TLS certificate verification to fail. This occurs because
    the wrong host name is selected during verification.
cves:
  - CVE-2022-24968
ghsas:
  - GHSA-m658-p24x-p74r
references:
  - fix: https://codeberg.org/mellium/xmpp/pulls/260
  - fix: https://codeberg.org/mellium/xmpp/commit/0d92aa486da69b71f2f4a30e62aa722c711b98ac
  - web: https://mellium.im/cve/cve-2022-24968/
  - web: https://nvd.nist.gov/vuln/detail/CVE-2022-24968
  - report: https://mellium.im/issue/259
